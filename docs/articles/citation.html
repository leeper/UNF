<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Data Citation with UNF • UNF</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Data Citation with UNF">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">UNF</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/algorithm.html">The UNF Algorithm</a>
    </li>
    <li>
      <a href="../articles/citation.html">Data Citation with UNF</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/leeper/UNF">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Data Citation with UNF</h1>
            
            <h4 class="date">2018-03-17</h4>
      
      <small>Source: <a href="https:/github.com/leeper/UNF/blob/master/vignettes/citation.Rmd"><code>vignettes/citation.Rmd</code></a></small>

    </div>

    
    
<div class="contents">
<p>This vignette shows some simple examples of how to use UNF signatures for data citation, using the <strong>UNF</strong> package on the <code>iris</code> dataset available in base R.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"UNF"</span>)</code></pre></div>
<p>The datasets should already be available in R, but we will load it explicitly just for good measure, along with the <strong>digest</strong> package for calculating MD5 sums:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"datasets"</span>)
<span class="kw">library</span>(<span class="st">"digest"</span>)
<span class="kw">data</span>(iris)</code></pre></div>
<div id="md5-the-current-alternative-to-unf" class="section level2">
<h2 class="hasAnchor">
<a href="#md5-the-current-alternative-to-unf" class="anchor"></a>MD5: The Current Alternative to UNF</h2>
<p>A common method of creating a unique hash for a data file (or any file) is the MD5 algorithm which, in most cases, produces a unique hash for a file that will change if the file is changed. This is useful from a data citation perspective because meaningful changes to the data will produce meaningful changes to the hash:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">digest</span>(iris, <span class="st">"md5"</span>)</code></pre></div>
<pre><code>## [1] "ff575c261c949d073b2895b05d1097c3"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">digest</span>(<span class="kw">head</span>(iris), <span class="st">"md5"</span>)</code></pre></div>
<pre><code>## [1] "89c2e2229a8ee084e56b2d43d3857e24"</code></pre>
<p>A subset of the <code>iris</code> data has a different MD5 hash than the full dataset. But, MD5 is sensitive to variable ordering:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">digest</span>(iris, <span class="st">"md5"</span>)</code></pre></div>
<pre><code>## [1] "ff575c261c949d073b2895b05d1097c3"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">digest</span>(<span class="kw">rev</span>(iris), <span class="st">"md5"</span>)</code></pre></div>
<pre><code>## [1] "2fa0a7e072b20e0a06e4cb22d5544dfd"</code></pre>
<p><code>iris</code> and <code>rev(iris)</code> contain identical data values, but the variables are simply in reverse order. This means that while MD5 is sensitive to meaningful changes in data contents, it is also sensitive to meaningless changes in data structure. Relatedly, MD5 is sensitive to irrelevant changes in variable naming that might result from modifying how data are read into memory:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris2 &lt;-<span class="st"> </span>iris
<span class="kw">names</span>(iris2) &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">"</span><span class="ch">\\</span><span class="st">."</span>,<span class="st">""</span>,<span class="kw">names</span>(iris2))
<span class="kw">names</span>(iris)</code></pre></div>
<pre><code>## [1] "Sepal.Length" "Sepal.Width"  "Petal.Length" "Petal.Width" 
## [5] "Species"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(iris2)</code></pre></div>
<pre><code>## [1] "SepalLength" "SepalWidth"  "PetalLength" "PetalWidth"  "Species"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">digest</span>(iris, <span class="st">"md5"</span>)</code></pre></div>
<pre><code>## [1] "ff575c261c949d073b2895b05d1097c3"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">digest</span>(iris2, <span class="st">"md5"</span>)</code></pre></div>
<pre><code>## [1] "4f2497ecd2142a362e129ddd274b378f"</code></pre>
<p>MD5 sums are also sensitive to the format in which data are actually preserved (i.e., they are format-dependent). The same data saved as an .RData file and as a CSV yield different MD5 hashes:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"tools"</span>)
<span class="kw">save</span>(iris, <span class="dt">file =</span> <span class="st">"iris.RData"</span>)
<span class="kw">write.csv</span>(iris, <span class="dt">file =</span> <span class="st">"iris.csv"</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)
<span class="kw">md5sum</span>(<span class="st">"iris.RData"</span>)</code></pre></div>
<pre><code>##                         iris.RData 
## "3384d567b1d964f9652ee5898d35ed5f"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">md5sum</span>(<span class="st">"iris.csv"</span>)</code></pre></div>
<pre><code>##                           iris.csv 
## "395d6abd001abf3760a1a794ef4c453c"</code></pre>
<p>And the <code>iris</code> dataset yields a different MD5 after being read back in from the CSV, despite being <em>identical</em>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># read CSV back into memory</span>
d &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">"iris.csv"</span>)
<span class="kw">identical</span>(iris, d)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">digest</span>(iris, <span class="st">"md5"</span>)</code></pre></div>
<pre><code>## [1] "ff575c261c949d073b2895b05d1097c3"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">digest</span>(d, <span class="st">"md5"</span>)</code></pre></div>
<pre><code>## [1] "d3c5d071001b61a9f6131d3004fd0988"</code></pre>
<p>This is problematic if moving between statistical software (e.g., R, Stata, SPSS, SAS, etc.), which prefer a native file format, or even between R sessions when data might be saved from a tabular format into native .RData and back again.</p>
<p>Finally, MD5 depends on insignificant numerical information and that dependency cannot be modified. Thus numbers that are identical (up to a specified level of precision) still yield different MD5 hashes:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x1 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">20</span>
x2 &lt;-<span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span><span class="fl">1e-7</span>
<span class="kw">identical</span>(<span class="kw">digest</span>(x1), <span class="kw">digest</span>(x2))</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
</div>
<div id="unf-solves-problems-of-md5" class="section level2">
<h2 class="hasAnchor">
<a href="#unf-solves-problems-of-md5" class="anchor"></a>UNF Solves Problems of MD5</h2>
<p>While file checksums are a common strategy for verifying a file, they are not well-suited to being used as global signatures for a dataset. A UNF differs from an ordinary file checksum in several important ways:</p>
<ol style="list-style-type: decimal">
<li>
<p><em>UNFs are format independent.</em> The UNF for a dataset will be the same regardless of whether the data is saved as a R binary format, SAS formatted file, Stata formatted file, etc., but file checksums will differ. The UNF is also independent of variable arrangement and naming, which can be unintentionally changed during file reading.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">write.csv</span>(iris, <span class="dt">file =</span> <span class="st">"iris.csv"</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)
iris2 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">"iris.csv"</span>)
<span class="kw">identical</span>(iris, iris2)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">identical</span>(<span class="kw"><a href="../reference/unf.html">unf</a></span>(iris), <span class="kw"><a href="../reference/unf.html">unf</a></span>(iris2))</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</li>
<li>
<p><em>UNFs are robust to insignificant rounding error.</em> This important when dealing with floating-point numeric values. A UNF will also be the same if the data differs in non-significant digits, a file checksum not. The UNF specification also allows tolerances for alternative levels of precision to meet the needs of any particular use case:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x1 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">20</span>
x2 &lt;-<span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span><span class="fl">1e-7</span>
<span class="kw">identical</span>(<span class="kw"><a href="../reference/unf.html">unf</a></span>(x1), <span class="kw"><a href="../reference/unf.html">unf</a></span>(x2))</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x3 &lt;-<span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span><span class="fl">1e-3</span>
<span class="kw">identical</span>(<span class="kw"><a href="../reference/unf.html">unf</a></span>(x1), <span class="kw"><a href="../reference/unf.html">unf</a></span>(x3))</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">identical</span>(<span class="kw"><a href="../reference/unf.html">unf</a></span>(x1, <span class="dt">digits =</span> <span class="dv">3</span>), <span class="kw"><a href="../reference/unf.html">unf</a></span>(x2, <span class="dt">digits =</span> <span class="dv">3</span>))</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</li>
<li>
<p><em>UNFs detect misinterpretation of the data by statistical software.</em> If the statistical software misreads the file, the resulting UNF will not match the original, but the file checksums may match. For example, numeric values read as character will produce a different UNF than those values read in as numerics.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x1 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">20</span>
x2 &lt;-<span class="st"> </span><span class="kw">as.character</span>(x1)
<span class="kw">identical</span>(<span class="kw"><a href="../reference/unf.html">unf</a></span>(x1), <span class="kw"><a href="../reference/unf.html">unf</a></span>(x2))</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
</li>
<li><p><em>UNFs are strongly tamper resistant.</em> Any accidental or intentional changes to data values will change the resulting UNF. Most file checksums and descriptive statistics detect only certain types of changes.</p></li>
</ol>
</div>
<div id="unf-in-practice" class="section level2">
<h2 class="hasAnchor">
<a href="#unf-in-practice" class="anchor"></a>UNF in Practice</h2>
<p>UNF has at least two significant use cases:</p>
<ol style="list-style-type: decimal">
<li>To create a format-independent citation to a specific (subset of) a version of a dataset for use in academic publishing, data sharing, and archiving.</li>
<li>To make versions and subsets explicit in the description of complex analyses.</li>
</ol>
<p>This section walks through both of these use cases.</p>
<div id="unf-as-data-citation" class="section level3">
<h3 class="hasAnchor">
<a href="#unf-as-data-citation" class="anchor"></a>UNF As Data Citation</h3>
<p>Because it is format-independent, the UNF hash is appropriated labeled a <em>universal</em> numeric fingerprint: any software application and any programming language can implement the algorithm. This means that data users can use UNF to create UNF-embedded citations for their data and use UNF citations to confirm they have the appropriate version and subset of a specified dataset.</p>
<p>For example, the <code>iris</code> dataset is cited in the R documentation (<code>? iris</code>) as:</p>
<blockquote>
<p>Anderson, Edgar (1935). The irises of the Gaspe Peninsula, <em>Bulletin of the American Iris Society</em>, 59, 2-5.</p>
</blockquote>
<p>While R users are familiar with these data and they have been a part of R for a long time, it is possible for anyone to go Anderson’s article, transcribe the data (or some part thereof) to a new dataset, start calling it <code>iris</code>, and use the same citation. A third user then, when holding <code>iris</code> in memory, has to wonder how can they confirm what version of <code>iris</code> they’re using? If the citation were expanded to include a UNF signature, there would be no question about whether the data in-hand matched the data cited.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/unf.html">unf</a></span>(iris)</code></pre></div>
<pre><code>## UNF6:6oVTvlCR+F1W1HTJ/QUmkA==</code></pre>
<pre><code>## &gt; Anderson, Edgar (1935). The irises of the Gaspe Peninsula, *Bulletin of the American Iris Society*, 59, 2-5. UNF6:6oVTvlCR+F1W1HTJ/QUmkA==</code></pre>
<p>When used in tandem with a persistent locator (e.g., a Handle or Data DOI), this rich citation not only persistently points data users to a location to find the data but also points them to a specific version of the data (of possibly many) available at that location. This means that as datasets evolve, expand, are corrected for errors, or move physical storage locations, a URI + UNF combination provides an incredibly valuable data citation. As an example, the following Handle and UNF citation provide a persistent link to replication files for an article. These files currently live on the Harvard University Dataverse Network, but the use of a handle and UNF mean interested users should be able to find the specific version of the data used in the original article indefinitely:</p>
<blockquote>
<p>James Druckman; Jordan Fein; Thomas Leeper, 2012, “Replication data for: A Source of Bias in Public Opinion Stability”, <a href="http://hdl.handle.net/1902.1/17864" class="uri">http://hdl.handle.net/1902.1/17864</a> UNF:5:esVZKwuUnh5kkpDhxXKLxA==</p>
</blockquote>
</div>
<div id="unf-as-in-line-data-description" class="section level3">
<h3 class="hasAnchor">
<a href="#unf-as-in-line-data-description" class="anchor"></a>UNF As In-line Data Description</h3>
<p>In addition to use as part of a persistent identifier of a dataset, UNF can also be used within an analysis to make subsetting and versioning explicit. For example, <code>iris</code> contains data on three species (stored in the <code>Species</code> variable). If we analyze these data together, we are working with one subset of the data (the subset of the whole):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/unf.html">unf</a></span>(iris)</code></pre></div>
<pre><code>## UNF6:6oVTvlCR+F1W1HTJ/QUmkA==</code></pre>
<p>But if we want to work with species individually, each of those subsets has a unique UNF:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/unf.html">unf</a></span>(iris[iris<span class="op">$</span>Species <span class="op">==</span><span class="st"> 'setosa'</span>,])</code></pre></div>
<pre><code>## UNF6:8rTAejPnZtElgtCerfvi3A==</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/unf.html">unf</a></span>(iris[iris<span class="op">$</span>Species <span class="op">==</span><span class="st"> 'versicolor'</span>,])</code></pre></div>
<pre><code>## UNF6:7ltC0QDS/iRK/QObr61L/Q==</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/unf.html">unf</a></span>(iris[iris<span class="op">$</span>Species <span class="op">==</span><span class="st"> 'virginica'</span>,])</code></pre></div>
<pre><code>## UNF6:UysJ51ubitBP+7vy4QTwiA==</code></pre>
<p>Similarly, if we wanted to work with a random subsample of observations in <code>iris</code>, we could use UNF to state explicitly the contents of that subset:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">123</span>)
<span class="kw"><a href="../reference/unf.html">unf</a></span>(iris[<span class="kw">sample</span>(<span class="dv">20</span>, <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(iris), <span class="ot">FALSE</span>),])</code></pre></div>
<pre><code>## UNF6:pXcTrdscvJ5nxkoQl8FhIA==</code></pre>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#md5-the-current-alternative-to-unf">MD5: The Current Alternative to UNF</a></li>
      <li><a href="#unf-solves-problems-of-md5">UNF Solves Problems of MD5</a></li>
      <li><a href="#unf-in-practice">UNF in Practice</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Thomas J. Leeper, Micah Altman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
