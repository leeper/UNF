<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tools for Creating Universal Numeric Fingerprints for Data • UNF</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><meta property="og:title" content="Tools for Creating Universal Numeric Fingerprints for Data">
<meta property="og:description" content="Computes a universal numeric fingerprint (UNF) for an R data
    object. UNF is a cryptographic hash or signature that can be used to uniquely
    identify (a version of) a rectangular dataset, or a subset thereof. UNF can
    be used, in tandem with a DOI, to form a persistent citation to a versioned
    dataset.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">UNF</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/algorithm.html">The UNF Algorithm</a>
    </li>
    <li>
      <a href="articles/citation.html">Data Citation with UNF</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/leeper/UNF">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    

    
    
<div class="contents">
<div id="universal-numeric-fingerprint" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#universal-numeric-fingerprint" class="anchor"></a>Universal Numeric Fingerprint</h1></div>
<p>UNF is a cryptographic hash or signature that can be used to uniquely identify (a version of) a rectangular dataset, or a subset thereof. UNF can be used, in tandem with a DOI or Handle, to form a persistent citation to a versioned dataset. A UNF signature is printed in the following form:</p>
<pre><code>UNF:[UNF version][:UNF header options]:[UNF hash]</code></pre>
<p>This allows a data consumer to quickly, easily, and definitively verify an in-hand data file against a data citation or to test for the equality of two datasets, regardless of their variable order or file format. UNF is used by <a href="http://www.thedata.org">The Dataverse Network</a> archiving software for data citation (making the UNF package a logical companion to the <a href="https://cran.r-project.org/package=dvn">dvn</a> package). This package implements UNF versions 3 and up (current version is 6). Some details on the UNF algorithm and the R implementation thereof are included in a package vignette (“The UNF Algorithm”) and details on use of UNF in data citation is available in another vignette (“Data Citation with UNF”).</p>
<p>Please report any mismatches between this implementation and any other implementation (including Dataverse’s) on <a href="https://github.com/leeper/UNF/issues">the issues page</a>!</p>
<div id="why-unfs" class="section level2">
<h2 class="hasAnchor">
<a href="#why-unfs" class="anchor"></a>Why UNFs?</h2>
<p>While file checksums are a common strategy for verifying a file (e.g., md5 sums are available for validating R packages), they are not well-suited to being used as global signatures for a dataset. A UNF differs from an ordinary file checksum in several important ways:</p>
<ol style="list-style-type: decimal">
<li>
<p><em>UNFs are format independent.</em> The UNF for a dataset will be the same regardless of whether the data is saved as a R binary format, SAS formatted file, Stata formatted file, etc., but file checksums will differ. The UNF is also independent of variable arrangement and naming, which can be unintentionally changed during file reading.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"digest"</span>)
<span class="kw">library</span>(<span class="st">"UNF"</span>)
<span class="kw">write.csv</span>(iris, <span class="dt">file =</span> <span class="st">"iris.csv"</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)
iris2 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">"iris.csv"</span>)
<span class="kw">identical</span>(iris, iris2)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">identical</span>(<span class="kw">digest</span>(iris, <span class="st">"md5"</span>), <span class="kw">digest</span>(iris2, <span class="st">"md5"</span>))</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">identical</span>(<span class="kw"><a href="reference/unf.html">unf</a></span>(iris), <span class="kw"><a href="reference/unf.html">unf</a></span>(iris2))</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</li>
<li>
<p><em>UNFs are robust to insignificant rounding error.</em> This important when dealing with floating-point numeric values. A UNF will also be the same if the data differs in non-significant digits, a file checksum not.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x1 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">20</span>
x2 &lt;-<span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span><span class="fl">1e-7</span>
<span class="kw">identical</span>(<span class="kw">digest</span>(x1), <span class="kw">digest</span>(x2))</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">identical</span>(<span class="kw"><a href="reference/unf.html">unf</a></span>(x1), <span class="kw"><a href="reference/unf.html">unf</a></span>(x2))</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</li>
<li>
<p><em>UNFs detect misinterpretation of the data by statistical software.</em> If the statistical software misreads the file, the resulting UNF will not match the original, but the file checksums may match. For example, numeric values read as character will produce a different UNF than those values read in as numerics.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x1 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">20</span>
x2 &lt;-<span class="st"> </span><span class="kw">as.character</span>(x1)
<span class="kw">identical</span>(<span class="kw"><a href="reference/unf.html">unf</a></span>(x1), <span class="kw"><a href="reference/unf.html">unf</a></span>(x2))</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
</li>
<li><p><em>UNFs are strongly tamper resistant.</em> Any accidental or intentional changes to data values will change the resulting UNF. Most file checksums and descriptive statistics detect only certain types of changes.</p></li>
</ol>
</div>
<div id="package-functionality" class="section level2">
<h2 class="hasAnchor">
<a href="#package-functionality" class="anchor"></a>Package Functionality</h2>
<ul>
<li>
<p><code><a href="reference/unf.html">unf()</a></code>: The core <code><a href="reference/unf.html">unf()</a></code> function calculates the UNF signature for almost any R object for UNF algorithm versions 3, 4, 4.1, 5, or 6, with options to control the rounding of numeric values, truncation of character strings, and some idiosyncratic details of the UNFv5 algorithm as implemented by Dataverse. <code><a href="reference/unf.html">unf()</a></code> is a wrapper for functions <code><a href="reference/unf.html">unf6()</a></code>, <code><a href="reference/unf.html">unf5()</a></code>, <code><a href="reference/unf.html">unf4()</a></code>, and <code><a href="reference/unf.html">unf3()</a></code>, which calculate vector-level UNF signatures.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/unf.html">unf</a></span>(iris)</code></pre></div>
<pre><code>## UNF6:6oVTvlCR+F1W1HTJ/QUmkA==</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(<span class="kw"><a href="reference/unf.html">unf</a></span>(iris))</code></pre></div>
<pre><code>## List of 5
##  $ unf      : chr "6oVTvlCR+F1W1HTJ/QUmkA=="
##  $ hash     : raw [1:32] ea 85 53 be ...
##  $ unflong  : chr "6oVTvlCR+F1W1HTJ/QUmkHEAyPC4LZiHnI1s2rURxbs="
##  $ formatted: chr "UNF6:6oVTvlCR+F1W1HTJ/QUmkA=="
##  $ variables: Named chr [1:5] "FnQvOCZE9tcn64bP78wLag==" "epaV+rjvURem8qIo0r9LBQ==" "KP6tL8gFSqnG3FLJ887o/g==" "TN39UY6H/vRGv4ARWQTXrw==" ...
##   ..- attr(*, "names")= chr [1:5] "Sepal.Length" "Sepal.Width" "Petal.Length" "Petal.Width" ...
##  - attr(*, "class")= chr "UNF"
##  - attr(*, "version")= num 6
##  - attr(*, "digits")= int 7
##  - attr(*, "characters")= int 128
##  - attr(*, "truncation")= int 128</code></pre>
</li>
<li>
<p><code>%unf%</code>: <code>%unf%</code> is a binary operator that can compare two R objects, or an R object against a “UNF” class summary (e.g., as stored in a study metadata record, or returned by <code><a href="reference/unf.html">unf()</a></code>). The function tests whether the objects are identical and, if they are not, provides object- and variable-level UNF comparisons between the two objects, checks for difference in the sorting of the two objects, and (for dataframes) reports indices for rows seemingly present in one object but missing from the other based on row-level hashes of variables common to both dataframes. This can be used both to compare two objects in general (e.g., to see whether two dataframes differ) as well as to debug incongruent UNFs. Two UNFs can differ dramatically due to minor changes like rounding, the deletion of an observation, addition of a variable, etc., so <code>%unf%</code> provides a useful tool for looking under the hood at the differences between data objects that might produce different UNF signatures.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">u &lt;-<span class="st"> </span><span class="kw"><a href="reference/unf.html">unf</a></span>(iris)
<span class="kw"><a href="reference/unf.html">unf</a></span>(iris) <span class="op">%unf%</span><span class="st"> </span>u</code></pre></div>
<pre><code>## Objects are identical
## 
## UNF6:6oVTvlCR+F1W1HTJ/QUmkA== 
## 
## UNF6:6oVTvlCR+F1W1HTJ/QUmkA==</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/unf.html">unf</a></span>(iris) <span class="op">%unf%</span><span class="st"> </span><span class="kw"><a href="reference/unf.html">unf</a></span>(iris[,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>])</code></pre></div>
<pre><code>## Objects are not identical
## 
## UNF6:6oVTvlCR+F1W1HTJ/QUmkA== 
## Mismatched variables:
## Petal.Width: TN39UY6H/vRGv4ARWQTXrw==
## Species: Xqh76nYY3z8eTfmL1KfxaQ==
## 
## UNF6:lEajCAiTPXcxJuP+hr8Kew==</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/unf.html">unf</a></span>(iris) <span class="op">%unf%</span><span class="st"> </span><span class="kw">head</span>(iris[,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>])</code></pre></div>
<pre><code>## Objects are not identical
## 
## UNF6:6oVTvlCR+F1W1HTJ/QUmkA== 
## Mismatched variables:
## Sepal.Length: FnQvOCZE9tcn64bP78wLag==
## Sepal.Width: epaV+rjvURem8qIo0r9LBQ==
## Petal.Length: KP6tL8gFSqnG3FLJ887o/g==
## Petal.Width: TN39UY6H/vRGv4ARWQTXrw==
## Species: Xqh76nYY3z8eTfmL1KfxaQ==
## 
## UNF6:0Ppu3rquJJrYvjkDePjGbA== 
## Mismatched variables:
## Sepal.Length: yMtrQJDMuxcSay0afKLz5A==
## Sepal.Width: e6etgUxSU/7XccLSwNzHVQ==
## Petal.Length: oSk42LS4+joAOdTAr9OChQ==</code></pre>
</li>
<li>
<p><code><a href="reference/as.unfvector.html">as.unfvector()</a></code> is an S3 generic method that standardizes any R vector into the standardized character representation described by the UNF specification. While this functionality is primarily for internal use, it can be helpful for clarifying the difference (or lack thereof) between floating point numbers or between objects with identical meaning but different class representations that perhaps resulted for flawed data importing:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># floating point ambiguity</span>
.<span class="dv">14</span><span class="op">*</span><span class="dv">10</span> <span class="op">==</span><span class="st"> </span><span class="fl">1.4</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/as.unfvector.html">as.unfvector</a></span>(.<span class="dv">14</span><span class="op">*</span><span class="dv">10</span>) <span class="op">==</span><span class="st"> </span><span class="kw"><a href="reference/as.unfvector.html">as.unfvector</a></span>(<span class="fl">1.4</span>)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># substantively irrelevant class differences</span>
<span class="kw">c</span>(0L, 1L) <span class="op">==</span><span class="st"> </span><span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] TRUE TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/as.unfvector.html">as.unfvector</a></span>(<span class="kw">c</span>(0L, 1L))</code></pre></div>
<pre><code>## [1] "+0.e+" "+1.e+"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/as.unfvector.html">as.unfvector</a></span>(<span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">TRUE</span>))</code></pre></div>
<pre><code>## [1] "+0.e+" "+1.e+"</code></pre>
</li>
</ul>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p><a href="https://cran.r-project.org/package=UNF"><img src="http://www.r-pkg.org/badges/version/UNF" alt="CRAN"></a> <a href="https://travis-ci.org/leeper/UNF"><img src="https://travis-ci.org/leeper/UNF.svg?branch=master" alt="Build Status"></a> <a href="https://ci.appveyor.com/project/leeper/unf"><img src="https://ci.appveyor.com/api/projects/status/tx3dkw1rsr9kijm4?svg=true" alt="Build status"></a> <a href="http://codecov.io/github/leeper/UNF?branch=master"><img src="http://codecov.io/github/leeper/UNF/coverage.svg?branch=master" alt="codecov.io"></a> <img src="http://cranlogs.r-pkg.org/badges/UNF" alt="Downloads"></p>
<p>UNF is on CRAN. To install the latest version, simply use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">"UNF"</span>)</code></pre></div>
<p>To install the latest development version of <strong>UNF</strong> from GitHub:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># latest (potentially unstable) version from GitHub</span>
<span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">"ghit"</span>)) {
    <span class="kw">install.packages</span>(<span class="st">"ghit"</span>)
}
ghit<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/ghit/topics/install_github">install_github</a></span>(<span class="st">"leeper/UNF"</span>)</code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2 class="hasAnchor">
<a href="#sidebar" class="anchor"></a>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cran.r-project.org/package=UNF">https://​cran.r-project.org/​package=UNF</a>
</li>
<li>Browse source code at <br><a href="https://github.com/leeper/UNF">https://​github.com/​leeper/​UNF</a>
</li>
<li>Report a bug at <br><a href="https://github.com/leeper/UNF/issues">https://​github.com/​leeper/​UNF/​issues</a>
</li>
</ul>
<h2>License</h2>
<p><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></p>
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing UNF</a></li>
</ul>
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Thomas J. Leeper <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-4097-6326" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid"></a> </li>
<li>Micah Altman <br><small class="roles"> Author </small>  </li>
</ul>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Thomas J. Leeper, Micah Altman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
